<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Hello World!</title>
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
</head>
<body style="background: white;">
    <div class="row">
        <div class="col" style="text-align: right;">
            <select id="select_crew1">
            </select>
            <h3>Score 1</h3>
        </div>
        <div class="col" style="text-align: left;">
            <select id="select_crew2">
            </select>
            <h3>Score 2</h3>
        </div>
    </div>
    <div class="row">
        <div class="col" style="text-align: center;">
            <button id="newcrew" type="button" onclick="populate()">Add a Crew</button>
        </div>
    </div>

    <hr>
    
    <div style="text-align: center;">
        <select>
            <option>1. Sawstep vs LQVII</option>
        </select>
    </div>
    <div style="text-align: center; margin-bottom: 1%;">
        <button>Add a Match</button>
    </div>
    <div class="row">
        <!-- Crew 1 Player (Left Side) -->
        <div class="col" style="text-align: right;">
            <label style="vertical-align: top;" for="select_p1">Crew 1 Player</label>
            <div>
                <select id="select_p1" name="select_p1">
                </select>
            </div>
        </div>
        <div class="col-1" style="text-align: right;">
            <label style="vertical-align: top;" for="select_char">Character</label>
            <div>
                <select id="select_char" name="select_char">
                    <option>Roy</option>
                    <option>Fox</option>
                </select>
            </div>
        </div>

        <!-- Stocks taken (Both, Center) -->
        <div class="col" style="text-align: center;">
            <div class="row" style="text-align: center;">
                <div class="col" style="text-align: right;">
                    <p>Score 1</p>
                    <h3>0</h3>
                </div>
                <div class="col" style="text-align: left;">
                    <p>Score 2</p>
                    <h3>1</h3>
                </div>
            </div>
        </div>
        <!-- Crew 2 Player (Right Side) -->
        <div class="col-1" style="text-align: left">
            <label style="vertical-align: top;" for="select_char">Character</label>
            <div>
                <select id="select_char" name="select_char">
                    <option>Roy</option>
                    <option>Fox</option>
                </select>
            </div>
        </div>
        <div class="col" style="text-align: left;">
            <label style="vertical-align: top;" for="select_p2">Crew 2 Player</label>
            <div>
                <select id="select_p2" name="select_p2">
                </select>
            </div>
        </div>
    </div>
    <div style="text-align: center;">
        <button>Submit Changes</button>
    </div>

</body>
</html>
<script>
function populate(){

    // Code referred to from https://www.skcript.com/svr/how-to-execute-python-scripts-in-electron-and-nodejs/
    const {PythonShell} = require('python-shell');

    let pyshell = new PythonShell('pyscripts/scripts.py');

    pyshell.on('message', function(message) {
        //Populate Crew Dropdowns
        let crews = JSON.parse(message)['crew_list'];
        let crews1 = document.getElementById("select_crew1");
        crews1.length = crews.length - 1;
        let crews2 = document.getElementById("select_crew2");
        crews2.length = crews.length - 1;

        let idx = 0;
        crews.forEach(element => {
            let opt = document.createElement('option');
            opt.text = element;
            let opt2 = document.createElement('option');
            opt2.text = element;
            crews1.add(opt);
            crews1.selectedIndex = idx;
            crews2.add(opt2);
            crews2.selectedIndex = idx;
        });

        let players = JSON.parse(message)['player_list'];
        console.log(players)
        let p1 = document.getElementById("select_p1");
        p1.length = crews.length - 1;
        let p2 = document.getElementById("select_p2");
        p2.length = crews.length - 1;

        idx = 0;
        players.forEach(element => {
            let opt = document.createElement('option');
            opt.text = element;
            let opt2 = document.createElement('option');
            opt2.text = element;
            p1.add(opt);
            p1.selectedIndex = idx;
            p2.add(opt2);
            p2.selectedIndex = idx;
        });
    })

    pyshell.end(function (err) {
    if (err){
        throw err;
    };
    console.log('finished');
    });
}

populate();
</script>